<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/vue-router/dist/vue-router.js"></script>
    <script type="text/javascript">
        window.onload = function () {
            document.documentElement.style.fontSize = document.documentElement.clientWidth / 640 * 100 + 'px';
            window.onresize = function () {
                document.documentElement.style.fontSize = document.documentElement.clientWidth / 640 * 100 + 'px';
            }
        }
    </script>
    <style>
        *{margin:0;padding:0;font-size: 0.18rem;}
        ul{list-style: none;}
        nav{list-style: none;}
        a{text-decoration: none;}
        img{vertical-align: top;}
        input{border: none;}
        .clearfix:after,.clearfix:before{content: "";display: table;}
        .clearfix:after{clear: both;}
        .box {
            width: 100%;
            height: auto;
            margin: 0 auto;
        }
        .content {
            width: 100%;
            height: auto;
        }
        .product {
            width: 25%;
            border: 1px #ccc solid;
            text-align: center;
            float: left;
            box-sizing: border-box;
        }
        .product li {
            width: 100%;
            height: 0.7rem;
            line-height: 0.7rem;
            box-sizing: border-box;
            border-bottom: 1px #ccc solid;
        }
        .information {
            width: 75%;
            height: auto;
            float: left;
        }
        .item-box,.jiesuan {
            width: 100%;
            height: 1.4rem;
            padding: 0.1rem;
            border-bottom: 1px #ccc solid;

            box-sizing: border-box;
        }
        .img {
            width: 1.2rem;
            height: 1.2rem;
            float: left;
        }
        .img img {
            width: 100%;
            height: 100%;
        }
        .text {
            width: 70%;
            margin-left: 0.1rem;
            float: left;
            position: relative;
        }
        .text .bt {
            margin-top: 0.3rem;

        }
        .price {
            color: orange;
        }

        .text .bt p {
            float: right;
        }

        .jian,
        .jia {
            width: 0.15rem;
            height: 0.15rem;
            text-align: center;
            line-height: 0.15rem;
            display: inline-block;
            border: 1px solid #ccc;
            border-radius: 50%;
            margin: 0 0.1rem;
        }

        .footer {
            width: 100%;
            height: 0.8rem;
            background: pink;
            position: fixed;
            bottom: 0;
            line-height: 0.8rem;
            padding-left: 0.2rem;
            font-size: 0.24rem;
            box-sizing: border-box;
        }

        .footer a {
            text-align: center;
            float: right;
            color: #fff;
            width: 1rem;
            height: 0.8rem;
            background-color: pink
        }
    </style>
</head>
<body>
    <div id='app'>
        <keep-alive>
            <router-view ref='reference'></router-view>
        </keep-alive>
    </div>
    <template id='aaa'>
        <div>
            <div class="box">
                <div class="content clearfix">
                    <ul class='product'>
                        <li @click='xianshi(index)' v-for='item,index in arr' :class="{'active':i==index}">
                            {{item.type}}
                        </li>
                    </ul>
                    <div class='information'>
                        <div class='item-box clearfix' v-for='item,index in arr[i].code'>
                            <div class="img">
                                <img :src="item.img" alt="">
                            </div>
                            <div class="text">
                                <h3>{{item.text}}</h3>
                                <div class='bt'>
                                    <span class='price'>{{item.price}}</span>
                                    <p>
                                        <span class='jian' @click='del(item)'>-</span>
                                        {{item.num || 0}}
                                        <span class='jia' @click='add(item)'>+</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <footer class='footer'>
                    总价:{{total}}元
                    <router-link :to="{name:'ccc',params:{selectList}}">去结算</router-link>
                </footer>
            </div>
        </div>
    </template>
    <template id='ccc'>
        <div>
            <div class='jiesuan' v-for='item in goodlist'>
                <div class="img">
                    <img :src="item.img" alt="">
                </div>
                <div class="text">
                    <h3>{{item.text}}</h3>
                    <div class='bt'>
                        <span class='price'>{{item.price}}</span>
                        <p>
                            {{item.num || 0}}
                        </p>
                    </div>
                </div>
            </div>
            <footer class='footer'>
                总价:{{total}}元
                <a>去支付</a>
            </footer>
        </div>
    </template>
    <script> 
         
        var aaa = {
            template: '#aaa',
            data() {
                return {
                    currentCategory: 0,
                    arr: [{
                        type: '热销商品',
                        code: [{
                            img: 'http://pic27.nipic.com/20130313/3371657_133115433177_2.jpg',
                            text: '特色红烧肉刀削面',
                            price: '￥23',

                        },
                        {
                            img: 'http://static.i3.xywy.com/cms/20140923/365d0f6e83ca0644ec7864a79a361ebf45788.jpg',
                            text: '狮子头',
                            price: '￥10',

                        },
                        {
                            img: 'http://img.juimg.com/tuku/yulantu/130514/240391-1305140J01917.jpg',
                            text: '鸡腿（个）',
                            price: '￥1',

                        }]
                    },
                    {
                        type: '本店新品',
                        code: [{
                            img: 'http://pic27.nipic.com/20130313/3371657_133115433177_2.jpg',
                            text: '蛋炒方便面',
                            price: '￥2',

                        },
                        {
                            img: 'http://pic27.nipic.com/20130313/3371657_133115433177_2.jpg',
                            text: '米饭（单点不送）',
                            price: '￥6',

                        }],
                    },
                    {
                        type: '熟食',
                        code: [{
                            img: 'http://pic27.nipic.com/20130313/3371657_133115433177_2.jpg',
                            text: '西红柿地蛋汤',
                            price: '￥2',

                        },
                        {
                            img: 'http://pic27.nipic.com/20130313/3371657_133115433177_2.jpg',
                            text: '油泼面',
                            price: '￥4',

                        },
                        {
                            img: 'http://pic27.nipic.com/20130313/3371657_133115433177_2.jpg',
                            text: '葱油拌面',
                            price: '￥3',

                        }]
                        },
                    ],
                    i: 0,
                }


            },
            methods: {
                xianshi(index) {
                    this.i = index;
                },
                del(item) {
                    if (item.num) {
                        if (item.num == 0) return;
                        item.num--;
                    }
                },
                add(item) {
                    console.log(item)
                    if (item.num) {
                        item.num++;
                    } else {
                        Vue.set(item, 'num', 1);
                    }
                }
            },
            computed: {
                selectList() {
                    var array = [];
                    this.arr.forEach(element => {
                        if (element.code && element.code.length > 0) {
                            element.code.forEach(el => {
                                if (el.num) {
                                    array.push(el);
                                }
                            });
                        }
                    });
                    return array;
                },
                total() {
                    var n = 0;
                    this.selectList.forEach(element => {
                        console.log((element.price).split('￥')[1]);
                        n += (element.price).split('￥')[1] * element.num;
                    });
                    return n.toFixed(2);
                }
            },
            watch: {
                selectList(v1) {
                    console.log(v1);
                }
            }
        }
       
        const router = new VueRouter({
            routes: [
                {
                    path: '/',
                    component: aaa
                }, {
                    path: '/ccc',
                    name: 'ccc',
                    component: ccc
                }
            ]
        })
        var vm = new Vue({
            router,
            el: '#app',
        })

    </script>
</body>

</html>