<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>模拟货单凭证</title>
    <!-- <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script> -->
    <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"> -->


    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script> -->

    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>


    <style>
        [v-cloak] {
            display: none;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        #app{
            width: 100%;
            height: auto;
            overflow: hidden;
        }

        table {
            border-spacing: 0;
            border-collapse: collapse;
            width: 100%;
        }

        table tr>td {
            border: 1px solid #000;
            line-height: 50px;
            height: 50px;
            text-align: center;
            vertical-align: top;
            position: relative;
        }

        .price-title {
            line-height: 25px;
            height: 25px;
        }

        input {
            width: 100%;
            line-height: 48px;
            position: absolute;
            top: 0;
            left: 0;
            border: 1px solid #ddd;
            box-shadow: none;
            display: none;
        }


        .red {
            color: red;
        }
    </style>

</head>

<body>
    <div id="app">
        <table>
            <tr>
                <td width="200px;">产品</td>
                <td width="200px;">数量</td>
                <td width="200px;">单价</td>
                <td :rowspan="(productsLength+1)">
                    <!-- 绑定属性一定要加一个冒号，或者v-bind都可以 -->
                    <table>
                        <tr>
                            <td colspan="8" class="price-title">金额</td>
                        </tr>

                        <tr>
                            <td class="price-title">千</td>
                            <td class="price-title">百</td>
                            <td class="price-title">十</td>
                            <td class="price-title">万</td>
                            <td class="price-title">千</td>
                            <td class="price-title">百</td>
                            <td class="price-title">十</td>
                            <td class="price-title">元</td>
                        </tr>
                        <tr v-for="n in productsLength">
                            <td>{{amountList[n-1]}}</td>
                            <td v-for="l in amountList[n-1]">
                                <!-- n-1应该是索引下标  -->
                                {{l}}
                            </td>
                        </tr>
                    </table>
                </td>
                <td>备注</td>
            </tr>
            <tr v-for="product in products">
                <td @click="showInput">{{product.name}}
                    <input type="text" v-model="product.name" @blur="hideIpnut()">
                </td>
                <td @click="showInput">{{product.num}}
                    <input type="text" v-model="product.num" @blur="hideIpnut()">
                </td>
                <td @click="showInput">{{product.price}}
                    <input type="text" v-model="product.price" @blur="hideIpnut()">
                </td>
                <td @click="showInput">{{product.beizhu}}
                    <input type="text" v-model="product.beizhu" @blur="hideIpnut()">
                </td>
            </tr>
            <tfoot>
                <tr>
                    <td>合计：</td>
                    <td colspan="4">{{total | chinese}}</td>
                </tr>
            </tfoot>
        </table>
        <!-- {{products}} -->
    </div>
</body>
<script>
    new Vue({
        el: '#app',
        data() {
            return {
                products: [
                    {
                        name: '',
                        price: '',
                        num: '',
                        beizhu: ''
                    }, {
                        name: '',
                        price: '1',
                        num: 321,
                        beizhu: ''
                    }, {
                        name: '',
                        price: '',
                        num: '',
                        beizhu: ''
                    }
                ]
            }
        },
        methods: {
            showInput(e){
                console.log(e.target.children[0])
                e.target.children[0].style.display = "block";
            },
            hideInput(e){
                e.target.style.display = "none";
            }
        },
        filters: {
            // funciton和computed类似，也要加一个function
            'chinese':function(val){
                var list1 = ['','壹','贰','叁','肆','伍','陆','柒','捌','玖'];
                var list2 = ['元整','拾','佰','仟','万','拾','佰','仟','亿'];

                var str = val.toString();//321
                var daxie = '';

                for(var i=0;i<str.length;i++){
                   daxie += list1[Number(str.charAt(i))] + list2[str.length-i-1];
                }
                return daxie;
            }
        },
        computed: {
            productsLength() {
                return this.products.length;
            },
            amountList() {
                var arr = [];

                //['00000321','00000321','00000321']

                this.products.forEach(element => {
                    // arr.push((element.price*element.num).toString());
                    var str = (element.price * element.num).toString();

                    var zeroLength = 8 - str.length;//srt的length即补0的长度

                    for (var i = 0; i < zeroLength; i++) {
                        str = ' ' + str;
                    };
                    arr.push(str);

                });
                return arr;
            },
            total() {
                var t = 0;
                this.products.forEach(element => {
                   t += element.price * element.num;
                });
                return t;
            },
        }
    })
</script>

</html>