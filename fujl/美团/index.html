<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<style>
			td{
			   width:100%;
				text-align: center;
			}
			.meng{
				background-image: url(img/1_02.jpg);

			}
		</style>
	</head>
	<script type="text/javascript">
		window.onload = function () {
			// 屏幕宽/设计稿宽*100
			document.documentElement.style.fontSize = document.documentElement.clientWidth / 1080*100+ 'px';

			window.onresize = function () {
				console.log('resize')
				document.documentElement.style.fontSize = document.documentElement.clientWidth / 1080*100 + 'px';
			}
		}
		</script>

	<body>
		<div id="box">
		
			<div style="width: 10.80rem;min-height: 6rem;background: #CCCCCC;margin: 0 auto;">
				<div style="overflow: hidden; border-bottom:2px solid #00BFFF ;">
					<div v-for="(i,$index) in ['列表','购物车']" style="float: left; text-align: center; width: 50%;line-height: 0.60rem;" @click="types = $index">
						{{i}}
					</div>
				</div>
				<div v-show="0 == types" style="overflow: hidden;">
					<div style="width: 100%;box-sizing: border-box;padding: 0.10rem; float: left; border: 1px solid #CCCCCC;"  v-for="i in list">
						<div style="width: 100%;height: 0.200rem;background: #00FFFF;">
							<div style="width: 80%; height:80%;" class="meng">  </div>
						</div>
						<div style="line-height: 0.40rem;">
						   {{i.n}} <span style="float: right;">￥ {{i.j}}</span>
						</div>
						<div style="line-height: 0.40rem;">
							<button style="float: right;" @click="btn(i)">加入购物车</button>
						</div>
					</div>
				</div>
				<div v-show="1 == types">
					<div v-if="go_list.length">
						<table width="100%">
							<tr>
								<td>名字</td>
								<td>价格</td>
								<td>数量</td>
								<td>小计</td>
								<td>操作</td>
							</tr>
						</table>
						<div v-for="(j,$index) in s_list">
							<h2>{{j}}</h2>
						<table width="100%">
							<tr v-for="i in go_list" v-if="i.d == j">
								<td>{{i.n}}</td>
								<td>￥ {{i.j}}</td>
								<td><button @click="jian(i.uid)">-</button>{{i.s}}<button @click="jia(i.uid)">+</button></td>
								<td>￥ {{i.j*i.s}}</td>
								<td><button @click="deletes(i.uid)">移除</button></td>
							</tr>
						</table>
						<p style="overflow: hidden;"><span style="float: right;">总计：{{arr[$index]}}</span></p>
						</div>
						<div>
						   共计：{{num}}
						</div>
					</div>
					 <div style="line-height: 50px; text-align: center;color: #FFFFFF;" v-else>
					 	购物车暂时没有数据，去<span style="color: #00BFFF;" @click="types=0">商城</span>看看吧
					 </div>
				</div>
			</div>
		</div>
	</body>
	<script src="vue.js"></script>
	<script>
		new Vue({
			el: '#box',
			computed:{
				z_go(){
					
			     console.log('hello')
			     return 12
				},
			   s_list(){
			   	var arr = []
			   	for(var i=0;i<this.go_list.length;i++){
			   		if(arr.indexOf(this.go_list[i].d) == -1){
			   			arr.push(this.go_list[i].d)
			   		}
			   	}
			   	return arr
			   }
			},
			methods:{
				jian(a){
					for(var i=0;i<this.go_list.length;i++){
						if(this.go_list[i].uid == a){
							this.go_list[i].s--
							if(this.go_list[i].s<=0){
								this.go_list[i].s = 1
							}
							this.j_arr()
						}
					}
				},
				jia(a){
					for(var i=0;i<this.go_list.length;i++){
						if(this.go_list[i].uid == a){
							this.go_list[i].s++
							this.j_arr()
						}
					}
				},
				deletes(a){
					for(var i=0;i<this.go_list.length;i++){
						if(this.go_list[i].uid == a){
							this.go_list.splice(i,1)
							this.j_arr()
						}
					}
				},
				btn(a){
					var types = true	
					for(var i=0;i<this.go_list.length;i++){
						if(this.go_list[i].uid == a.uid){
							types = false
							this.go_list[i].s++
						}
					}
					if(types){
						a.s = 1
						this.go_list.push(a)
					}
					this.j_arr()
				},
				j_arr(){
					var arr = []      
			     for(var i=0;i<this.s_list.length;i++){
			     	var num = 0
			   	   for(var j=0;j<this.go_list.length;j++){
			   	   	if(this.s_list[i] == this.go_list[j].d){
//			   	   		
			   	   		num+=this.go_list[j].j*this.go_list[j].s
			   	   	}
			   	   }
			   	   arr.push(num)
			   	   this.arr = arr
			   	   
			   	}
			     var num_z = 0
					for(var i=0;i<this.go_list.length;i++){
						num_z+=this.go_list[i].j*this.go_list[i].s
					}
					this.num = num_z
				}
			},
			data: {
				num:0,
				types: 0,
				go_list:[],
				arr:'',
				list: [{
						uid: 1,
						n: '苹果',
						j: 4.99,
						d: '果农'
					},
					{
						uid: 2,
						n: '香蕉',
						j: 7.99,
						d: '果农'
					},
					{
						uid: 3,
						n: '橘子',
						j: 3.99,
						d: '云南'
					},
					{
						uid: 4,
						n: '葡萄',
						j: 12.99,
						d: '云南'
					},
					{
						uid: 5,
						n: '联想',
						j: 4999,
						d: '联想旗舰店'
					},
					{
						uid: 7,
						n: '平板',
						j: 4999,
						d: '联想旗舰店'
					},
					{
						uid: 6,
						n: '外星人',
						j: 14999,
						d: '外星人旗舰店'
					},
					{
						uid: 8,
						n: '衣柜',
						j: 2999,
						d: '全友家居'
					},
					{
						uid: 9,
						n: '双人床',
						j: 3999,
						d: '全友家居'
					}
				]
			}
		})
	</script>

</html>